db.MyBatch.update({ name:'Anish' },
	{
		$set : {
			marks : 90 ,
			college : 'PICT'
		}
	})


db.MyBatch.update({ name:'Ashwin' },
	{
		$set : {
			marks : 80,
			college : 'PICT'
		}
	})


db.MyBatch.update({ name:'Dhruv' },
	{
		$set : {
			marks :75,
			college : 'PICT'
		}
	})


db.MyBatch.update({ name:'Mihir Kumar' },
	{
		$set : {
			marks : 87,
			college : 'PICT'
		}
	})


db.MyBatch.update({ name:'Apoorv' },
	{
		$set : {
			marks : 85,
			college : 'PICT'
		}
	})


db.MyBatch.aggregate([{$group : {_id : "$college", marks_sum : {$sum : "$marks"}}}])
db.MyBatch.aggregate([{$group : {_id : "$college", marks_avg : {$avg : "$marks"}}}])
db.MyBatch.aggregate([{$group : {_id : "$college", marks_min : {$min : "$marks"}}}])
db.MyBatch.aggregate([{$group : {_id : "$college", marks_max : {$max : "$marks"}}}])


db.MyBatch.aggregate([
		{
			$group : 
			{
				_id : "$college",
				marks_sum : {$sum : "$marks"},
				marks_avg : {$avg : "$marks"},
				marks_min : {$min : "$marks"}, 
				marks_max : {$max : "$marks"}
			}
		}
	])


db.MyBatch.aggregate([
	{$group : {
		_id : "$class",
		marks_sum : {$sum : "$marks"},
		marks_avg : {$avg : "$marks"},
		marks_min : {$min : "$marks"}, 
		marks_max : {$max : "$marks"}
	}}])


db.MyBatch.aggregate([
	{$group : {
		_id : "",
		marks_sum : {$sum : "$marks"},
		marks_avg : {$avg : "$marks"},
		marks_min : {$min : "$marks"}, 
		marks_max : {$max : "$marks"}
	}}])


db.MyBatch.mapReduce(
		function() { emit(this.class, this.marks); },
		function(key, values ) { return Array.sum(values) },
		{
			out: "Summation"
		}
	).find().pretty()


db.MyBatch.mapReduce(
		function() { emit(this.class, this.marks); },
		function(key, values ) { return Array.avg(values) },
		{
			out: "Average"
		}
	).find().pretty()


